// GeniE tutorial Topside with Detailed Modelling Joint
//
GenieRules.Compatibility.version = "V7.14-05";
GenieRules.Tolerances.useTolerantModelling = true;
GenieRules.Tolerances.angleTolerance = 2 deg;
GenieRules.Meshing.autoSimplifyTopology = true;
GenieRules.Meshing.eliminateInternalEdges = true;
GenieRules.BeamCreation.DefaultCurveOffset = ReparameterizedBeamCurveOffset();
GenieRules.Transformation.DefaultConnectedCopy = false;
GenieRules.Units.setOutputUnits("m", "kN", "delC");
GenieRules.Units.setInputUnit(Length, "m");
GenieRules.Units.setInputUnit(Force, "kN");
GenieRules.Units.setInputUnit(TempDiff, "delC");
// Import the database (gnx file) of the Topside model
importer = WorkspaceImporter();
importer.DoImport("../Topside/Topside.gnx");
// Explode the beams connected to the joint
SetNoLoadcase();
Validate(Bm5.primitivePartCount == 4);
Bm5.explode(IndexedNameMask(97));
Validate(Bm97);
Validate(Bm98);
Validate(Bm99);
Validate(Bm100);
Validate(Bm13.primitivePartCount == 5);
Bm13.explode(IndexedNameMask(101));
Validate(Bm101);
Validate(Bm102);
Validate(Bm103);
Validate(Bm104);
Validate(Bm105);
Validate(Bm28.primitivePartCount == 5);
Bm28.explode(IndexedNameMask(106));
Validate(Bm106);
Validate(Bm107);
Validate(Bm108);
Validate(Bm109);
Validate(Bm110);
// Divided beams at their midpoints
Bm5 = Bm101.divideAtEccentric(0.5);
Bm13 = Bm99.divideAtEccentric(0.5);
Bm28 = Bm100.divideAtEccentric(0.5);
Bm111 = Bm102.divideAtEccentric(0.5);
Bm112 = Bm110.divideAtEccentric(0.5);
// Change section for part of the tube
Bm110.section = P_leg_norm_35;
// Convert beams to plate/shell model
StructureConverter = StructureToPlateUtility();
StructureConverter.ConvertBeam(Bm100);
StructureConverter.ConvertBeam(Bm102);
StructureConverter.ConvertBeam(Bm106);
StructureConverter.ConvertBeam(Bm108);
StructureConverter.ConvertBeam(Bm109);
StructureConverter.ConvertBeam(Bm110);
StructureConverter.ConvertBeam(Bm13);
StructureConverter.ConvertBeam(Bm5);
// Delete superfluous support rigid links
Delete(Sp5);
Delete(Sp8);
Delete(Sp9);
Delete(Sp10);
// Delete cone beam
Delete(Bm107);
// Create guide curves for cone and then create cone
Tck3.setDefault();
Curve1 = GuideNURBS(ModelCurve(Point(23.55275496 m,5.052754961 m,0.5 m), Point(24 m,4.8675 m,0.5 m), Point(24.44724504 m,5.052754961 m,0.5 m), Point(24.5843538 m,5.257952729 m,0.5 m), Point(24.6325 m,5.5 m,0.5 m), Point(24.5843538 m,5.742047271 m,0.5 m), Point(24.44724504 m,5.947245039 m,0.5 m), Point(24 m,6.1325 m,0.5 m), Point(23.55275496 m,5.947245039 m,0.5 m), Point(23.3675 m,5.5 m,0.5 m), Point(23.55275496 m,5.052754961 m,0.5 m)));
Curve2 = GuideNURBS(ModelCurve(Point(24.27046834 m,5.229531656 m,1.5 m), Point(24.3825 m,5.5 m,1.5 m), Point(24.27046834 m,5.770468344 m,1.5 m), Point(24.14637641 m,5.853383921 m,1.5 m), Point(24 m,5.8825 m,1.5 m), Point(23.85362359 m,5.853383921 m,1.5 m), Point(23.72953166 m,5.770468344 m,1.5 m), Point(23.6175 m,5.5 m,1.5 m), Point(23.72953166 m,5.229531656 m,1.5 m), Point(24 m,5.1175 m,1.5 m), Point(24.27046834 m,5.229531656 m,1.5 m)));
Pl1 = SkinCurves(Array(Curve1, Curve2));
// Replace support point by two 180-degree support curves
Sc1 = SupportCurve(GuideNURBS(ModelCurve(Point(24.44724504 m,5.052754961 m,0 m), Point(24.6325 m,5.5 m,0 m), Point(24.44724504 m,5.947245039 m,0 m), Point(24.24204727 m,6.084353804 m,0 m), Point(24 m,6.1325 m,0 m), Point(23.75795273 m,6.084353804 m,0 m), Point(23.55275496 m,5.947245039 m,0 m))));
Sc1.localSystemRule = ConstantLocalSystem(LocalSystem(Vector3d(1 m,0 m,0 m), Vector3d(0 m,0 m,1 m)));
Sc2 = SupportCurve(GuideNURBS(ModelCurve(Point(23.55275496 m,5.947245039 m,0 m), Point(23.3675 m,5.5 m,0 m), Point(23.55275496 m,5.052754961 m,0 m), Point(24 m,4.8675 m,0 m), Point(24.44724504 m,5.052754961 m,0 m))));
Sc2.localSystemRule = ConstantLocalSystem(LocalSystem(Vector3d(1 m,0 m,0 m), Vector3d(0 m,0 m,1 m)));
Delete(Sp1);
// Delete parts of I-beams inside cylinder
Validate(Bm100_segment1_1.primitivePartCount == 6);
Bm100_segment1_1.explode(IndexedNameMask(2));
Validate(Pl2);
Validate(Pl3);
Validate(Pl4);
Validate(Pl5);
Validate(Pl6);
Validate(Pl7);
Validate(Bm100_segment1_2.primitivePartCount == 4);
Bm100_segment1_2.explode(IndexedNameMask(8));
Validate(Pl8);
Validate(Pl9);
Validate(Pl10);
Validate(Pl11);
Validate(Bm100_segment1_3.primitivePartCount == 6);
Bm100_segment1_3.explode(IndexedNameMask(12));
Validate(Pl12);
Validate(Pl13);
Validate(Pl14);
Validate(Pl15);
Validate(Pl16);
Validate(Pl17);
Validate(Bm102_segment1_1.primitivePartCount == 5);
Bm102_segment1_1.explode(IndexedNameMask(18));
Validate(Pl18);
Validate(Pl19);
Validate(Pl20);
Validate(Pl21);
Validate(Pl22);
Validate(Bm102_segment1_2.primitivePartCount == 4);
Bm102_segment1_2.explode(IndexedNameMask(23));
Validate(Pl23);
Validate(Pl24);
Validate(Pl25);
Validate(Pl26);
Validate(Bm102_segment1_3.primitivePartCount == 5);
Bm102_segment1_3.explode(IndexedNameMask(27));
Validate(Pl27);
Validate(Pl28);
Validate(Pl29);
Validate(Pl30);
Validate(Pl31);
Validate(Bm13_segment1_1.primitivePartCount == 5);
Bm13_segment1_1.explode(IndexedNameMask(32));
Validate(Pl32);
Validate(Pl33);
Validate(Pl34);
Validate(Pl35);
Validate(Pl36);
Validate(Bm13_segment1_2.primitivePartCount == 4);
Bm13_segment1_2.explode(IndexedNameMask(37));
Validate(Pl37);
Validate(Pl38);
Validate(Pl39);
Validate(Pl40);
Validate(Bm13_segment1_3.primitivePartCount == 5);
Bm13_segment1_3.explode(IndexedNameMask(41));
Validate(Pl41);
Validate(Pl42);
Validate(Pl43);
Validate(Pl44);
Validate(Pl45);
Validate(Bm5_segment1_1.primitivePartCount == 4);
Bm5_segment1_1.explode(IndexedNameMask(46));
Validate(Pl46);
Validate(Pl47);
Validate(Pl48);
Validate(Pl49);
Validate(Bm5_segment1_2.primitivePartCount == 4);
Bm5_segment1_2.explode(IndexedNameMask(50));
Validate(Pl50);
Validate(Pl51);
Validate(Pl52);
Validate(Pl53);
Validate(Bm5_segment1_3.primitivePartCount == 4);
Bm5_segment1_3.explode(IndexedNameMask(54));
Validate(Pl54);
Validate(Pl55);
Validate(Pl56);
Validate(Pl57);
Delete(Pl15);
Delete(Pl20);
Delete(Pl30);
Delete(Pl34);
Delete(Pl40);
Delete(Pl43);
Delete(Pl53);
Delete(Pl5);
Delete(Pl2);
Delete(Pl3);
Delete(Pl4);
Delete(Pl8);
Delete(Pl9);
Delete(Pl14);
Delete(Pl13);
Delete(Pl12);
Delete(Pl21);
Delete(Pl19);
Delete(Pl23);
Delete(Pl24);
Delete(Pl28);
Delete(Pl29);
Delete(Pl36);
Delete(Pl35);
Delete(Pl39);
Delete(Pl44);
Delete(Pl45);
Delete(Pl47);
Delete(Pl48);
Delete(Pl52);
Delete(Pl56);
Delete(Pl55);
// Add plates to strengthen joint
Tck1.setDefault();
Pl2 = Plate(Point(22.7,4.2,4.2825),Point(25.3,4.2,4.2825),Point(25.3,6.8,4.2825),Point(22.7,6.8,4.2825));
Validate(Pl2.primitivePartCount == 5);
Pl2.explode(IndexedNameMask(58));
Validate(Pl58);
Validate(Pl59);
Validate(Pl60);
Validate(Pl61);
Validate(Pl62);
Delete(Pl60);
Point1 = Point(22.7 m,4.2 m,4.2825 m);
Point2 = Point1.copyTranslate(Vector3d(1,0,0));
Curve7 = CreateCircleFromCenterAndRadius(Point(22.7 m,4.2 m,4.2825 m), Point(23.7 m,4.2 m,4.2825 m), Point(22.7 m,5.35 m,4.2825 m));
Pl3 = Pl58.divide(Curve7);
Delete(Pl58);
Curve8 = Curve7.copyTranslate(Vector3d(2.6 m,0 m,0 m));
Curve9 = Curve7.copyTranslate(Vector3d(2.6 m,2.6 m,0 m));
Curve10 = Curve7.copyTranslate(Vector3d(0 m,2.6 m,0 m));
Pl4 = Pl61.divide(Curve8);
Delete(Pl4);
Pl4 = Pl62.divide(Curve9);
Delete(Pl4);
Pl4 = Pl59.divide(Curve10);
Delete(Pl59);
Pl54.flipNormal();
Pl17.flipNormal();
Pl16.flipNormal();
Pl27.flipNormal();
Pl31.flipNormal();
Pl41.flipNormal();
Pl42.flipNormal();
Pl57.flipNormal();
MyModelTransformerMap = ObjectNameMap();
MyModelTransformerMap.Add(Pl3, "Pl5");
MyModelTransformerMap.Add(Pl4, "Pl8");
MyModelTransformerMap.Add(Pl61, "Pl9");
MyModelTransformerMap.Add(Pl62, "Pl12");
ModelTransformer(MyModelTransformerMap).copyTranslate(Vector3d(0 m,0 m,-0.565 m));
Pl49.flipNormal();
Pl6.flipNormal();
Pl7.flipNormal();
Pl22.flipNormal();
Pl18.flipNormal();
Pl32.flipNormal();
Pl33.flipNormal();
Pl46.flipNormal();
Pl54.join(Pl57);
Pl54.join(Pl61);
Pl54.join(Pl16);
Pl54.join(Pl17);
Pl54.join(Pl62);
Pl54.join(Pl31);
Pl54.join(Pl27);
Pl54.join(Pl4);
Pl54.join(Pl42);
Pl54.join(Pl41);
Pl54.join(Pl3);
Pl54.simplifyTopology();
Pl49.join(Pl9);
Pl49.join(Pl6);
Pl49.join(Pl7);
Pl49.join(Pl12);
Pl49.join(Pl22);
Pl49.join(Pl18);
Pl49.join(Pl8);
Pl49.join(Pl33);
Pl49.join(Pl32);
Pl49.join(Pl46);
Pl49.join(Pl5);
Pl49.simplifyTopology();
// Create mesh property and assign this to plates/shells
MeshProperty1 = MeshDensity(0.15);
Pl10.meshDensity = MeshProperty1;
Pl25.meshDensity = MeshProperty1;
Pl49.meshDensity = MeshProperty1;
Pl54.meshDensity = MeshProperty1;
Pl11.meshDensity = MeshProperty1;
Pl26.meshDensity = MeshProperty1;
Pl37.meshDensity = MeshProperty1;
Pl38.meshDensity = MeshProperty1;
Pl50.meshDensity = MeshProperty1;
Pl51.meshDensity = MeshProperty1;
Sc1.meshDensity = MeshProperty1;
Sc2.meshDensity = MeshProperty1;
Bm106_segment1.meshDensity = MeshProperty1;
Bm108_segment1.meshDensity = MeshProperty1;
Bm109_segment1.meshDensity = MeshProperty1;
Bm110_segment1.meshDensity = MeshProperty1;
Pl1.meshDensity = MeshProperty1;
// Run static analysis
SimplifyTopology();
Analysis1.execute();
