// Piled jacket analysis tutorial
//
GenieRules.Compatibility.version = "V7.14-05";
GenieRules.Tolerances.useTolerantModelling = true;
GenieRules.Tolerances.angleTolerance = 2 deg;

GenieRules.Meshing.autoSimplifyTopology = true;
GenieRules.Meshing.eliminateInternalEdges = true;
GenieRules.BeamCreation.DefaultCurveOffset = ReparameterizedBeamCurveOffset();
GenieRules.Transformation.DefaultConnectedCopy = false;
GenieRules.Units.setOutputUnits("m", "kN", "delC");
GenieRules.Units.setInputUnit(Length, "m");
GenieRules.Units.setInputUnit(Force, "kN");
GenieRules.Units.setInputUnit(TempDiff, "delC");
// Create pipe sections
Pipe06 = PipeSection(0.6, 0.01);
Pipe12 = PipeSection(1.2, 0.03);
Pipe16 = PipeSection(1.6, 0.03 m);
Pipe21 = PipeSection(2.1, 0.08);
Pipe22 = PipeSection(2.2, 0.08 m);
Pipe32 = PipeSection(3.2, 0.09);
// Create plate thicknesses
Th2 = Thickness(0.2);
Th4 = Thickness(0.4);
Th6 = Thickness(0.6);
// Create steel material for beams and a special material for plates
Steel = MaterialLinear(3.56E5, 7.85 tonne/m^3, 210000000 kPa, 0.3, 0, 0);
PlateMaterial = MaterialLinear(356000 kPa, 0.785 tonne/m^3, 210000000 kPa, 0.3, 0 delC^-1, 0 kN*s/m);
// Create two guide planes, at top and at bottom of legs
GuidePlane1 = GuidePlane(Point(-10,-7.5,138),Point(10,-7.5,138),Point(10,7.5,138),Point(-10,7.5,138),1,1,1,1);
GuidePlane1.snapmode = true;
GuidePlane2 = GuidePlane(Point(-22.5,-17.5,0),Point(22.5,-17.5,0),Point(22.5,17.5,0),Point(-22.5,17.5,0),1,1,1,1);
GuidePlane2.snapmode = true;
// Set default cross section and material and create four legs
Pipe32.setDefault();
Steel.setDefault();
Bm1 = StraightBeam(Point(-22.5 m,-17.5 m,0 m), Point(-10 m,-7.5 m,138 m));
Bm2 = StraightBeam(Point(22.5 m,-17.5 m,0 m), Point(10 m,-7.5 m,138 m));
Bm3 = StraightBeam(Point(22.5 m,17.5 m,0 m), Point(10 m,7.5 m,138 m));
Bm4 = StraightBeam(Point(-22.5 m,17.5 m,0 m), Point(-10 m,7.5 m,138 m));
// Set default cross section and create bracings
Pipe16.setDefault();
Bm5 = StraightBeam(Point(-22.04710145 m,-17.13768116 m,5 m), Point(22.04710145 m,-17.13768116 m,5 m));
Bm6 = StraightBeam(Point(22.04710145 m,-17.13768116 m,5 m), Point(22.04710145 m,17.13768116 m,5 m));
Bm7 = StraightBeam(Point(22.04710145 m,17.13768116 m,5 m), Point(-22.04710145 m,17.13768116 m,5 m));
Bm8 = StraightBeam(Point(-22.04710145 m,17.13768116 m,5 m), Point(-22.04710145 m,-17.13768116 m,5 m));
Bm9 = StraightBeam(Point(-22.04710145 m,-17.13768116 m,5 m), Point(22.04710145 m,17.13768116 m,5 m));
Bm10 = StraightBeam(Point(22.04710145 m,-17.13768116 m,5 m), Point(-22.04710145 m,17.13768116 m,5 m));
Bm11 = StraightBeam(Point(-22.04710145 m,-17.13768116 m,5 m), Point(18.87681159 m,-14.60144928 m,40 m));
Bm12 = StraightBeam(Point(18.87681159 m,-14.60144928 m,40 m), Point(22.04710145 m,17.13768116 m,5 m));
Bm13 = StraightBeam(Point(22.04710145 m,17.13768116 m,5 m), Point(-18.87681159 m,14.60144928 m,40 m));
Bm14 = StraightBeam(Point(-18.87681159 m,14.60144928 m,40 m), Point(-22.04710145 m,-17.13768116 m,5 m));
Bm15 = StraightBeam(Point(-18.87681159 m,-14.60144928 m,40 m), Point(22.04710145 m,-17.13768116 m,5 m));
Bm16 = StraightBeam(Point(22.04710145 m,-17.13768116 m,5 m), Point(18.87681159 m,14.60144928 m,40 m));
Bm17 = StraightBeam(Point(18.87681159 m,14.60144928 m,40 m), Point(-22.04710145 m,17.13768116 m,5 m));
Bm18 = StraightBeam(Point(-22.04710145 m,17.13768116 m,5 m), Point(-18.87681159 m,-14.60144928 m,40 m));
Bm19 = StraightBeam(Point(-18.87681159 m,-14.60144928 m,40 m), Point(16.15942029 m,-12.42753623 m,70 m));
Bm20 = StraightBeam(Point(16.15942029 m,-12.42753623 m,70 m), Point(18.87681159 m,14.60144928 m,40 m));
Bm21 = StraightBeam(Point(18.87681159 m,14.60144928 m,40 m), Point(-16.15942029 m,12.42753623 m,70 m));
Bm22 = StraightBeam(Point(-16.15942029 m,12.42753623 m,70 m), Point(-18.87681159 m,-14.60144928 m,40 m));
Bm23 = StraightBeam(Point(-16.15942029 m,-12.42753623 m,70 m), Point(18.87681159 m,-14.60144928 m,40 m));
Bm24 = StraightBeam(Point(18.87681159 m,-14.60144928 m,40 m), Point(16.15942029 m,12.42753623 m,70 m));
Bm25 = StraightBeam(Point(16.15942029 m,12.42753623 m,70 m), Point(-18.87681159 m,14.60144928 m,40 m));
Bm26 = StraightBeam(Point(-18.87681159 m,14.60144928 m,40 m), Point(-16.15942029 m,-12.42753623 m,70 m));
Pipe12.setDefault();
Bm27 = StraightBeam(Point(-12.98913043 m,-9.891304348 m,105 m), Point(12.98913043 m,-9.891304348 m,105 m));
Bm28 = StraightBeam(Point(12.98913043 m,-9.891304348 m,105 m), Point(12.98913043 m,9.891304348 m,105 m));
Bm29 = StraightBeam(Point(12.98913043 m,9.891304348 m,105 m), Point(-12.98913043 m,9.891304348 m,105 m));
Bm30 = StraightBeam(Point(-12.98913043 m,9.891304348 m,105 m), Point(-12.98913043 m,-9.891304348 m,105 m));
Bm31 = StraightBeam(Point(-10.27173913 m,-7.717391304 m,135 m), Point(10.27173913 m,-7.717391304 m,135 m));
Bm32 = StraightBeam(Point(10.27173913 m,-7.717391304 m,135 m), Point(10.27173913 m,7.717391304 m,135 m));
Bm33 = StraightBeam(Point(10.27173913 m,7.717391304 m,135 m), Point(-10.27173913 m,7.717391304 m,135 m));
Bm34 = StraightBeam(Point(-10.27173913 m,7.717391304 m,135 m), Point(-10.27173913 m,-7.717391304 m,135 m));
Bm35 = StraightBeam(Point(-16.15942029 m,-12.42753623 m,70 m), Point(12.98913043 m,-9.891304348 m,105 m));
Bm36 = StraightBeam(Point(12.98913043 m,-9.891304348 m,105 m), Point(16.15942029 m,12.42753623 m,70 m));
Bm37 = StraightBeam(Point(16.15942029 m,12.42753623 m,70 m), Point(-12.98913043 m,9.891304348 m,105 m));
Bm38 = StraightBeam(Point(-12.98913043 m,9.891304348 m,105 m), Point(-16.15942029 m,-12.42753623 m,70 m));
Bm39 = StraightBeam(Point(-12.98913043 m,-9.891304348 m,105 m), Point(16.15942029 m,-12.42753623 m,70 m));
Bm40 = StraightBeam(Point(16.15942029 m,-12.42753623 m,70 m), Point(12.98913043 m,9.891304348 m,105 m));
Bm41 = StraightBeam(Point(12.98913043 m,9.891304348 m,105 m), Point(-16.15942029 m,12.42753623 m,70 m));
Bm42 = StraightBeam(Point(-16.15942029 m,12.42753623 m,70 m), Point(-12.98913043 m,-9.891304348 m,105 m));
Bm43 = StraightBeam(Point(-12.98913043 m,-9.891304348 m,105 m), Point(10.27173913 m,-7.717391304 m,135 m));
Bm44 = StraightBeam(Point(10.27173913 m,-7.717391304 m,135 m), Point(12.98913043 m,9.891304348 m,105 m));
Bm45 = StraightBeam(Point(12.98913043 m,9.891304348 m,105 m), Point(-10.27173913 m,7.717391304 m,135 m));
Bm46 = StraightBeam(Point(-10.27173913 m,7.717391304 m,135 m), Point(-12.98913043 m,-9.891304348 m,105 m));
Bm47 = StraightBeam(Point(-10.27173913 m,-7.717391304 m,135 m), Point(12.98913043 m,-9.891304348 m,105 m));
Bm48 = StraightBeam(Point(12.98913043 m,-9.891304348 m,105 m), Point(10.27173913 m,7.717391304 m,135 m));
Bm49 = StraightBeam(Point(10.27173913 m,7.717391304 m,135 m), Point(-12.98913043 m,9.891304348 m,105 m));
Bm50 = StraightBeam(Point(-12.98913043 m,9.891304348 m,105 m), Point(-10.27173913 m,-7.717391304 m,135 m));
// Create split points for four horizontal bracings near top of jacket to insert near vertical bracings
Bm27.splitAt(0.5);
Bm29.splitAt(0.5);
Bm31.splitAt(0.5);
Bm33.splitAt(0.5);
Bm51 = StraightBeam(Point(0 m,-7.717391304 m,135 m), Point(0 m,-9.891304348 m,105 m));
Bm52 = StraightBeam(Point(0 m,7.717391304 m,135 m), Point(0 m,9.891304348 m,105 m));
// Create horizontal diagonal bracings at elevations
Pipe16.setDefault();
Bm53 = StraightBeam(Point(-18.87681159 m,-14.60144928 m,40 m), Point(18.87681159 m,14.60144928 m,40 m));
Bm54 = StraightBeam(Point(18.87681159 m,-14.60144928 m,40 m), Point(-18.87681159 m,14.60144928 m,40 m));
Bm55 = StraightBeam(Point(-16.15942029 m,-12.42753623 m,70 m), Point(16.15942029 m,12.42753623 m,70 m));
Bm56 = StraightBeam(Point(16.15942029 m,-12.42753623 m,70 m), Point(-16.15942029 m,12.42753623 m,70 m));
Bm57 = StraightBeam(Point(-12.98913043 m,-9.891304348 m,105 m), Point(12.98913043 m,9.891304348 m,105 m));
Bm58 = StraightBeam(Point(12.98913043 m,-9.891304348 m,105 m), Point(-12.98913043 m,9.891304348 m,105 m));
Bm59 = StraightBeam(Point(-10.27173913 m,-7.717391304 m,135 m), Point(10.27173913 m,7.717391304 m,135 m));
Bm60 = StraightBeam(Point(10.27173913 m,-7.717391304 m,135 m), Point(-10.27173913 m,7.717391304 m,135 m));
// Create segments for a leg and change cross section
Bm1.divideSegmentAtEccentric(1,0.575848871);
Bm1.divideSegmentAtEccentric(2,0.05091188302);
Bm1.SetSegmentSection(3, Pipe22);
Cone1 = ConeSection(1, true);
Bm1.SetSegmentSection(2, Cone1);
// Delete the three other legs and copy the segmented leg to the deleted positions
Delete(Bm2);
Delete(Bm3);
Delete(Bm4);
MyModelTransformerMap = ObjectNameMap();
MyModelTransformerMap.Add(Bm1, "Bm2");
ModelTransformer(MyModelTransformerMap).copyMirror(Point(0,0,0), Vector3d(1,0,0));
MyModelTransformerMap = ObjectNameMap();
MyModelTransformerMap.Add(Bm1, "Bm3");
MyModelTransformerMap.Add(Bm2, "Bm4");
ModelTransformer(MyModelTransformerMap).copyMirror(Point(0,0,0), Vector3d(0,1,0));
// Create stubs at top of legs
Bm61 = StraightBeam(Point(-10 m,-7.5 m,138 m), Point(-10 m,-7.5 m,138 m + 5 m));
Bm61.section = Pipe22;
MyModelTransformerMap = ObjectNameMap();
MyModelTransformerMap.Add(Bm61, "Bm62");
ModelTransformer(MyModelTransformerMap).copyTranslate(Vector3d(20 m,0 m,0 m));
MyModelTransformerMap = ObjectNameMap();
MyModelTransformerMap.Add(Bm61, "Bm63");
MyModelTransformerMap.Add(Bm62, "Bm64");
ModelTransformer(MyModelTransformerMap).copyTranslate(Vector3d(0 m,15 m,0 m));
// Create simplified conductor supports
Bm65 = StraightBeam(Point(-3.992957746 m,3 m,135 m), Point(3.992957746 m,3 m,135 m));
Bm66 = StraightBeam(Point(-3.93956044 m,3 m,105 m), Point(3.93956044 m,3 m,105 m));
Bm67 = StraightBeam(Point(-3.900874636 m,3 m,70 m), Point(3.900874636 m,3 m,70 m));
Bm68 = StraightBeam(Point(-3.878411911 m,3 m,40 m), Point(3.878411911 m,3 m,40 m));
Bm69 = StraightBeam(Point(-3.859408034 m,3 m,5 m), Point(3.859408034 m,3 m,5 m));
// Create conductors
Cond1 = StraightBeam(Point(-2,3,0), Point(-2,3,143));
Cond1.section = Pipe06;
MyModelTransformerMap = ObjectNameMap();
MyModelTransformerMap.Add(Cond1, "Bm71");
ModelTransformer(MyModelTransformerMap).copyTranslate(Vector3d(2,0,0), 2);
Rename(Bm71,"Cond2");
Rename(Bm72,"Cond3");
// Create non-structural beam type and assign to the conductors
NonStruct = BeamTypeNonstruct();
Cond1.beamType = NonStruct;
Cond2.beamType = NonStruct;
Cond3.beamType = NonStruct;
// Fix the lower ends of the conductors
Sp1 = SupportPoint(Point(-2 m,3 m,0 m));
Sp2 = SupportPoint(Point(0 m,3 m,0 m));
Sp3 = SupportPoint(Point(2 m,3 m,0 m));
// Create simplified topside structure
Th6.setDefault();
PlateMaterial.setDefault();
Pl1 = Plate(Point(-10 m - 12 m,-7.5 m,143 m),Point(10 m + 16 m,-7.5 m,143 m),Point(10 m + 16 m,7.5 m,143 m),Point(-10 m - 12 m,7.5 m,143 m));
MyModelTransformerMap = ObjectNameMap();
MyModelTransformerMap.Add(Pl1, "Pl2");
ModelTransformer(MyModelTransformerMap).copyTranslate(Vector3d(0,0,9));
MyModelTransformerMap = ObjectNameMap();
MyModelTransformerMap.Add(Pl1, "Pl3");
ModelTransformer(MyModelTransformerMap).copyTranslate(Vector3d(0,0,17));
Th4.setDefault();
Pl4 = Plate(Point(-22 m,-7.5 m,143 m),Point(-22 m,7.5 m,143 m),Point(-22 m,7.5 m,160 m),Point(-22 m,-7.5 m,160 m));
MyModelTransformerMap = ObjectNameMap();
MyModelTransformerMap.Add(Pl4, "Pl5");
ModelTransformer(MyModelTransformerMap).copyTranslate(Vector3d(12 m,0 m,0 m));
MyModelTransformerMap = ObjectNameMap();
MyModelTransformerMap.Add(Pl4, "Pl6");
ModelTransformer(MyModelTransformerMap).copyTranslate(Vector3d(32 m,0 m,0 m));
MyModelTransformerMap = ObjectNameMap();
MyModelTransformerMap.Add(Pl4, "Pl7");
ModelTransformer(MyModelTransformerMap).copyTranslate(Vector3d(48 m,0 m,0 m));
Th2.setDefault();
Pl8 = Plate(Point(-22 m,-7.5 m,143 m),Point(26 m,-7.5 m,143 m),Point(26 m,-7.5 m,160 m),Point(-22 m,-7.5 m,160 m));
autoMSet = Set();
autoMSet.clear();
autoMSet.add(Pl8);
autoMSet.moveTranslate(Vector3d(0 m,10.5 m,0 m),geUNCONNECTED);
Delete(autoMSet);
// Add mass points
Mass1 = PointMass(Point(-22 m,-7.5 m,160 m), 120);
Mass2 = Mass1.copyTranslate(Vector3d(12 m,0 m,0 m));
Mass3 = Mass1.copyTranslate(Vector3d(32 m,0 m,0 m));
Mass4 = Mass1.copyTranslate(Vector3d(48 m,0 m,0 m));
Mass5 = Mass1.copyTranslate(Vector3d(0 m,10.5 m,0 m));
Mass6 = Mass2.copyTranslate(Vector3d(0 m,10.5 m,0 m));
Mass7 = Mass3.copyTranslate(Vector3d(0 m,10.5 m,0 m));
Mass8 = Mass4.copyTranslate(Vector3d(0 m,10.5 m,0 m));
Mass9 = Mass1.copyTranslate(Vector3d(0 m,15 m,0 m));
Mass10 = Mass2.copyTranslate(Vector3d(0 m,15 m,0 m));
Mass11 = Mass3.copyTranslate(Vector3d(0 m,15 m,0 m));
Mass12 = Mass4.copyTranslate(Vector3d(0 m,15 m,0 m));
// Create sets
Jacket = Set();
Jacket.add(Bm1);
Jacket.add(Bm10);
Jacket.add(Bm11);
Jacket.add(Bm12);
Jacket.add(Bm13);
Jacket.add(Bm14);
Jacket.add(Bm15);
Jacket.add(Bm16);
Jacket.add(Bm17);
Jacket.add(Bm18);
Jacket.add(Bm19);
Jacket.add(Bm2);
Jacket.add(Bm20);
Jacket.add(Bm21);
Jacket.add(Bm22);
Jacket.add(Bm23);
Jacket.add(Bm24);
Jacket.add(Bm25);
Jacket.add(Bm26);
Jacket.add(Bm27);
Jacket.add(Bm28);
Jacket.add(Bm29);
Jacket.add(Bm3);
Jacket.add(Bm30);
Jacket.add(Bm31);
Jacket.add(Bm32);
Jacket.add(Bm33);
Jacket.add(Bm34);
Jacket.add(Bm35);
Jacket.add(Bm36);
Jacket.add(Bm37);
Jacket.add(Bm38);
Jacket.add(Bm39);
Jacket.add(Bm4);
Jacket.add(Bm40);
Jacket.add(Bm41);
Jacket.add(Bm42);
Jacket.add(Bm43);
Jacket.add(Bm44);
Jacket.add(Bm45);
Jacket.add(Bm46);
Jacket.add(Bm47);
Jacket.add(Bm48);
Jacket.add(Bm49);
Jacket.add(Bm5);
Jacket.add(Bm50);
Jacket.add(Bm51);
Jacket.add(Bm52);
Jacket.add(Bm53);
Jacket.add(Bm54);
Jacket.add(Bm55);
Jacket.add(Bm56);
Jacket.add(Bm57);
Jacket.add(Bm58);
Jacket.add(Bm59);
Jacket.add(Bm6);
Jacket.add(Bm60);
Jacket.add(Bm61);
Jacket.add(Bm62);
Jacket.add(Bm63);
Jacket.add(Bm64);
Jacket.add(Bm65);
Jacket.add(Bm66);
Jacket.add(Bm67);
Jacket.add(Bm68);
Jacket.add(Bm69);
Jacket.add(Bm7);
Jacket.add(Bm8);
Jacket.add(Bm9);
Conductors = Set();
Conductors.add(Cond1);
Conductors.add(Cond2);
Conductors.add(Cond3);
Legs = Set();
Legs.add(Bm1);
Legs.add(Bm2);
Legs.add(Bm3);
Legs.add(Bm4);
Topside = Set();
Topside.add(Mass1);
Topside.add(Mass10);
Topside.add(Mass11);
Topside.add(Mass12);
Topside.add(Mass2);
Topside.add(Mass3);
Topside.add(Mass4);
Topside.add(Mass5);
Topside.add(Mass6);
Topside.add(Mass7);
Topside.add(Mass8);
Topside.add(Mass9);
Topside.add(Pl1);
Topside.add(Pl2);
Topside.add(Pl3);
Topside.add(Pl4);
Topside.add(Pl5);
Topside.add(Pl6);
Topside.add(Pl7);
Topside.add(Pl8);
// Create mesh density and assign to all plates
MeshProperty1 = MeshDensity(2m);
Pl1.meshDensity = MeshProperty1;
Pl2.meshDensity = MeshProperty1;
Pl3.meshDensity = MeshProperty1;
Pl4.meshDensity = MeshProperty1;
Pl5.meshDensity = MeshProperty1;
Pl6.meshDensity = MeshProperty1;
Pl7.meshDensity = MeshProperty1;
Pl8.meshDensity = MeshProperty1;
// Create piles
Pipe21.setDefault();
Pile1 = Pile(Point(-22.5 m,-17.5 m,0 m), Point(-29.29347826 m,-22.93478261 m,-75 m));
Pile2 = Pile(Point(22.5 m,-17.5 m,0 m), Point(29.29347826 m,-22.93478261 m,-75 m));
Pile3 = Pile(Point(22.5 m,17.5 m,0 m), Point(29.29347826 m,22.93478261 m,-75 m));
Pile4 = Pile(Point(-22.5 m,17.5 m,0 m), Point(-29.29347826 m,22.93478261 m,-75 m));
PileType1 = PileCharacteristics(1, tcInfinite);
Pile1.pileCharacteristics = PileType1;
Pile2.pileCharacteristics = PileType1;
Pile3.pileCharacteristics = PileType1;
Pile4.pileCharacteristics = PileType1;
// Create soil data
Sand1 = Sand(false,1,1.99,40,0 kPa/m);
Sand2 = Sand(false,1,1.99,36,0 kPa/m);
Sand5 = Sand(false,1,2.04,37,0 kPa/m);
Clay3 = Clay(false,1,1.94,0.01,200,0 m,100,-100 m);
Clay3.apiJFactor = 0.5;
Clay4 = Clay(false,1,1.94,0.01,300,0 m,130,-100 m);
Clay4.apiJFactor = 0.5;
Scour1 = Scour(0.5,1,20);
SoilCurves1 = SoilCurves(pyAPI1987,tzAPI1993,qzAPI1993);
SoilData1 = SoilData(-1,0.5,5,3,0.01,0 kPa,0);
SoilData2 = SoilData(-1,0.5,15,11,0.01,0 kPa,0);
SoilData3 = SoilData(-1,0.5,45,45,0.01,0 kPa,0);
SoilData4 = SoilData(-1,0.5,200,200,0.01,0 kPa,0);
SoilData5 = SoilData(-1,0.5,250,250,0.01,0 kPa,0);
SoilData6 = SoilData(-1,0.5,120,120,0.01,3000 kPa,0.05);
// Create a location
Location1 = Location(124, -75 m);
Location1.gravity = 9.80665 m/s^2;
Location1.air.density = 0.001226 tonne/m^3;
Location1.air.kinematicViscosity = 1.462e-05 m^2/s;
Location1.water.density = 1.025 tonne/m^3;
Location1.water.kinematicViscosity = 1.19e-06 m^2/s;
Location1.seabed.normaldirection = Vector3d(0 m,0 m,1 m);
Location1.relativeSoilLayers = false;
Location1.seabed.z = 0;
Location1.seabed.seabedDelta = Scour1;
Location1.clearSoilLayers();
Location1.insertSoilBorder(-1.5);
Location1.soil(1).soilType = Sand1;
Location1.soil(1).soilCurves = SoilCurves1;
Location1.soil(1).soilData = SoilData1;
Location1.insertSoilBorder(-3.5);
Location1.soil(2).soilType = Sand1;
Location1.soil(2).soilCurves = SoilCurves1;
Location1.soil(2).soilData = SoilData2;
Location1.insertSoilBorder(-5.5);
Location1.soil(3).soilType = Sand2;
Location1.soil(3).soilCurves = SoilCurves1;
Location1.soil(3).soilData = SoilData3;
Location1.insertSoilBorder(-14.5);
Location1.soil(4).soilType = Clay3;
Location1.soil(4).soilCurves = SoilCurves1;
Location1.soil(4).soilData = SoilData4;
Location1.soil(4).numberOfSublayers = 3;
Location1.insertSoilBorder(-70);
Location1.soil(5).soilType = Clay4;
Location1.soil(5).soilCurves = SoilCurves1;
Location1.soil(5).soilData = SoilData5;
Location1.soil(5).numberOfSublayers = 15;
Location1.insertSoilBorder(-100);
Location1.soil(6).soilType = Sand5;
Location1.soil(6).soilCurves = SoilCurves1;
Location1.soil(6).soilData = SoilData6;
Location1.soil(6).numberOfSublayers = 3;
// Create a current profile
CurrentProfile1_Elevations = Array(30,0,-44,-124);
CurrentProfile1_Directions = Array(0 deg,0 deg,0 deg,0 deg);
CurrentProfile1_Velocities = Array(1.1,1.1,0.5,0);
CurrentProfile1 = CurrentProfileRelDir(CurrentProfile1_Elevations,CurrentProfile1_Directions,CurrentProfile1_Velocities,dtAlongHeading);
CurrentProfile1.setAbsoluteElevations(false);
// Create a regular wave set
WaveSet1 = RegularWaveSet();
WaveSet1.heightType = rwHeight;
WaveSet1.add(RegularWave(270, 26, WavePeriod(14), -60, rwHeight));
WaveSet1.add(RegularWave(180, 15, WavePeriod(12), -60, rwHeight));
WaveSet1.add(RegularWave(90, 28, WavePeriod(14), -60, rwHeight));
WaveSet1.add(RegularWave(0, 27, WavePeriod(15), -60, rwHeight));
// Create a wave load condition
Condition1 = DeterministicTime(Location1);
Condition1.waterSurface.regularWaveSet = WaveSet1;
Condition1.populate();
Condition1.addCalmSea();
Condition1.component(1).water.current(CurrentProfile1);
Condition1.component(1).waterSurface.waveModel(Stokes5());
Condition1.component(2).water.current(CurrentProfile1);
Condition1.component(2).waterSurface.waveModel(Stokes5());
Condition1.component(3).water.current(CurrentProfile1);
Condition1.component(3).waterSurface.waveModel(Stokes5());
Condition1.component(4).water.current(CurrentProfile1);
Condition1.component(4).waterSurface.waveModel(Stokes5());
// Define hydro properties
Flooding1 = Flooding(1);
MorisonConstant1 = MorisonCoefficients(0,0.7,0.7,0,2,2);
MarineGrowthZLevel1 = MarineGrowthZLevelFunction();
MarineGrowthZLevel1.add(0,0.1,0,1.1);
MarineGrowthZLevel1.add(-24,0.1,0,1.1);
MarineGrowthZLevel1.add(-124,0.01,0,1.1);
MarineGrowthZLevel1.useInForceCalculations(true);
MarineGrowthZLevel1.setAbsoluteElevations(false);
// Assign hydro properties
Legs.flooding = Flooding1;
Jacket.morison = MorisonConstant1;
Jacket.marineGrowth  = MarineGrowthZLevel1;
Conductors.morison = MorisonConstant1;
Conductors.marineGrowth  = MarineGrowthZLevel1;
// Create static loads
Gravity = LoadCase();
Gravity.setAcceleration(Vector3d(0 m/s^2,0 m/s^2,-9.80665 m/s^2));
Gravity.includeSelfWeight();
Gravity.includeStructureMassWithRotationField();
WindN = LoadCase();
WindE = LoadCase();
WindS = LoadCase();
WindW = LoadCase();
WindN.setCurrent();
SLoad1 = SurfaceLoad(WindN, FootprintPolygon(Point(26 m,3 m,143 m), Point(26 m,3 m,160 m), Point(-22 m,3 m,160 m), Point(-22 m,3 m,143 m)), Pressure2dConstant(5));
WindE.setCurrent();
SLoad3 = SurfaceLoad(WindE, FootprintPolygon(Point(26 m,-7.5 m,143 m), Point(26 m,7.5 m,143 m), Point(26 m,7.5 m,160 m), Point(26 m,-7.5 m,160 m)), Pressure2dConstant(-7));
WindS.setCurrent();
SLoad4 = SurfaceLoad(WindS, FootprintPolygon(Point(26 m,3 m,143 m), Point(26 m,3 m,160 m), Point(-22 m,3 m,160 m), Point(-22 m,3 m,143 m)), Pressure2dConstant(-6));
WindW.setCurrent();
SLoad5 = SurfaceLoad(WindW, FootprintPolygon(Point(-22 m,-7.5 m,160 m), Point(-22 m,7.5 m,160 m), Point(-22 m,7.5 m,143 m), Point(-22 m,-7.5 m,143 m)), Pressure2dConstant(-9));
// Create a wave load analysis
WaveLoadAnalysis = Analysis(true);
WaveLoadAnalysis.add(MeshActivity());
WaveLoadAnalysis.step(1).smartLoadCombinations = false;
WaveLoadAnalysis.step(1).writeLoadCombinationsOnFirstLevelAsBSELL = true;
WaveLoadAnalysis.add(WaveLoadActivity(Condition1));
WaveLoadAnalysis.add(PileSoilAnalysis(Condition1));
WaveLoadAnalysis.step(3).sestra.useSestra10(true);
WaveLoadAnalysis.add(LoadResultsActivity());
// Edit wave load analysis
WaveLoadAnalysis.step(2).deterministicSeastates().populate();
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(1).dopplerOption(doUseRules);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(1).dataPhase(NoStretching,5 deg,24,buOn,BothLoads,1,1,124 m);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(2).dopplerOption(doUseRules);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(2).dataPhase(NoStretching,5 deg,24,buOn,BothLoads,1,1,124 m);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(3).dopplerOption(doUseRules);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(3).dataPhase(NoStretching,5 deg,24,buOn,BothLoads,1,1,124 m);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(4).dopplerOption(doUseRules);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(4).dataPhase(NoStretching,5 deg,24,buOn,BothLoads,1,1,124 m);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(5).dopplerOption(doOff);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(5).dataPhase(NoStretching,0,1,buOn,NoDesignLoads,1,1,124 m);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(1).dopplerOption(doUseRules);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(1).dataPhase(NoStretching,5 deg,24,buOff,BothLoads,1,1,124 m);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(2).dopplerOption(doUseRules);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(2).dataPhase(NoStretching,5 deg,24,buOff,BothLoads,1,1,124 m);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(3).dopplerOption(doUseRules);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(3).dataPhase(NoStretching,5 deg,24,buOff,BothLoads,1,1,124 m);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(4).dopplerOption(doUseRules);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(4).dataPhase(NoStretching,5 deg,24,buOff,BothLoads,1,1,124 m);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(5).dopplerOption(doOff);
WaveLoadAnalysis.step(2).deterministicSeastates().seastate(5).dataPhase(NoStretching,0,1,buOn,NoDesignLoads,1,1,124 m);
// Create load combinations
NorMaxSh = LoadCombination(WaveLoadAnalysis);
NorMaxSh.addCase(Gravity, 1.2);
NorMaxSh.addCase(WindN, 1.6);
NorMaxSh.addCase(WaveLoadAnalysis.WLC(1, 1), 1.6);
NorMaxSh.addCase(WaveLoadAnalysis.WLC(5, 1), 1);
//
NorMaxMo = LoadCombination(WaveLoadAnalysis);
NorMaxMo.addCase(Gravity, 1.2);
NorMaxMo.addCase(WindN, 1.6);
NorMaxMo.addCase(WaveLoadAnalysis.WLC(1, 2), 1.6);
NorMaxMo.addCase(WaveLoadAnalysis.WLC(5, 1), 1);
//
EasMaxSh = LoadCombination(WaveLoadAnalysis);
EasMaxSh.addCase(Gravity, 1.2);
EasMaxSh.addCase(WindN, 1.6);
EasMaxSh.addCase(WaveLoadAnalysis.WLC(2, 1), 1.6);
EasMaxSh.addCase(WaveLoadAnalysis.WLC(5, 1), 1);
//
EasMaxMo = LoadCombination(WaveLoadAnalysis);
EasMaxMo.addCase(Gravity, 1.2);
EasMaxMo.addCase(WindN, 1.6);
EasMaxMo.addCase(WaveLoadAnalysis.WLC(2, 2), 1.6);
EasMaxMo.addCase(WaveLoadAnalysis.WLC(5, 1), 1);
//
SouMaxSh = LoadCombination(WaveLoadAnalysis);
SouMaxSh.addCase(Gravity, 1.2);
SouMaxSh.addCase(WindN, 1.6);
SouMaxSh.addCase(WaveLoadAnalysis.WLC(3, 1), 1.6);
SouMaxSh.addCase(WaveLoadAnalysis.WLC(5, 1), 1);
//
SouMaxMo = LoadCombination(WaveLoadAnalysis);
SouMaxMo.addCase(Gravity, 1.2);
SouMaxMo.addCase(WindN, 1.6);
SouMaxMo.addCase(WaveLoadAnalysis.WLC(3, 2), 1.6);
SouMaxMo.addCase(WaveLoadAnalysis.WLC(5, 1), 1);
//
WesMaxSh = LoadCombination(WaveLoadAnalysis);
WesMaxSh.addCase(Gravity, 1.2);
WesMaxSh.addCase(WindN, 1.6);
WesMaxSh.addCase(WaveLoadAnalysis.WLC(4, 1), 1.6);
WesMaxSh.addCase(WaveLoadAnalysis.WLC(5, 1), 1);
//
WesMaxMo = LoadCombination(WaveLoadAnalysis);
WesMaxMo.addCase(Gravity, 1.2);
WesMaxMo.addCase(WindN, 1.6);
WesMaxMo.addCase(WaveLoadAnalysis.WLC(4, 2), 1.6);
WesMaxMo.addCase(WaveLoadAnalysis.WLC(5, 1), 1);
// Select load combinations for analysis
WaveLoadAnalysis.step(3).sestra.LoadCaseCollection = LoadCaseSubset(WaveLoadAnalysis, Array(NorMaxSh, NorMaxMo, EasMaxSh, EasMaxMo, SouMaxSh, SouMaxMo, WesMaxSh, WesMaxMo));
// Run analysis
SimplifyTopology();
WaveLoadAnalysis.execute();
